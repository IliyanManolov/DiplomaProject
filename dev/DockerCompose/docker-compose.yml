services:

  homeowners.proxy:
    image: nginx
    container_name: homeowners-dev-proxy
    hostname: local-dev.homeowners.com
    ports: 
      - 443:443
    depends_on:
      homeowners.web.api:
        condition: service_started
    volumes:
      - ./proxy-config:/etc/nginx/conf.d
      # - ./Certificates:/etc/nginx/cert

  homeowners.web.api:
    image: ${DOCKER_REGISTRY-}homeownerswebapi
    container_name: homeowners-dev-api
    build:
      context: ./../../
      dockerfile: API/HomeOwners.Web.API/Dockerfile
    volumes:
      - ./../../dev/DockerCompose/Config:/_config
      - ./dev-keys:/keys
    environment:
      - HomeOwnersConfigurationPath=/_config/api-configuration.json
      - ASPNETCORE_URLS=http://+:8080
      - ASPNETCORE_ENVIRONMENT=Development
 
  homeowners.web.ui:
    image: ${DOCKER_REGISTRY-}homeownerswebui
    container_name: homeowners-dev-ui
    build:
      context: ./../../
      dockerfile: Frontend/HomeOwners.Web.UI/Dockerfile
    volumes:
      - ./../../dev/DockerCompose/Config:/_config
      - ./dev-keys:/keys
    environment:
      - HomeOwnersConfigurationPath=/_config/web-configuration.json
      - ASPNETCORE_URLS=http://+:8080
      - ASPNETCORE_ENVIRONMENT=Development